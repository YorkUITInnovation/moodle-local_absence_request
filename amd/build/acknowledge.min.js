define("local_absence_request/acknowledge",["exports","core/ajax","core/notification"],(function(_exports,_ajax,_notification){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification);const absenceAcknowledge=new class{init(){this.bindEvents()}bindEvents(){document.addEventListener("click",(e=>{if(e.target.classList.contains("local-absence-request-acknowledge")){e.preventDefault();const id=e.target.getAttribute("data-id");this.toggleAcknowledge(id,e.target)}})),document.addEventListener("change",(e=>{if("select_all_absences"===e.target.id){const isChecked=e.target.checked;document.querySelectorAll(".absence-checkbox").forEach((checkbox=>{checkbox.checked=isChecked})),this.updateBulkButton()}})),document.addEventListener("change",(e=>{e.target.classList.contains("absence-checkbox")&&(this.updateSelectAllState(),this.updateBulkButton())})),document.addEventListener("click",(e=>{"bulk_acknowledge_btn"===e.target.id&&(e.preventDefault(),this.bulkAcknowledge())}))}toggleAcknowledge(id,element){const newStatus=element.classList.contains("fa-check")?0:1;_ajax.default.call([{methodname:"local_absence_request_acknowledge_request",args:{id:parseInt(id),acknowledged:newStatus}}])[0].done((response=>{if(response.success){this.updateAcknowledgeIcon(element,newStatus);const checkbox=document.querySelector(`.absence-checkbox[data-id="${id}"]`);checkbox&&(checkbox.checked=1===newStatus),this.updateSelectAllState(),this.updateBulkButton()}else _notification.default.addNotification({message:response.message||"Error updating acknowledgment",type:"error"})})).fail((error=>{console.error("AJAX Error:",error),_notification.default.addNotification({message:"Error communicating with server: "+(error.message||"Unknown error"),type:"error"})}))}bulkAcknowledge(){const selectedIds=[];document.querySelectorAll(".absence-checkbox:checked").forEach((checkbox=>{selectedIds.push(parseInt(checkbox.getAttribute("data-id")))})),0!==selectedIds.length?_ajax.default.call([{methodname:"local_absence_request_bulk_acknowledge",args:{ids:selectedIds}}])[0].done((response=>{response.success?(selectedIds.forEach((id=>{const icon=document.querySelector(`.local-absence-request-acknowledge[data-id="${id}"]`);icon&&this.updateAcknowledgeIcon(icon,1)})),this.updateSelectAllState(),this.updateBulkButton(),_notification.default.addNotification({message:`Successfully acknowledged ${selectedIds.length} absence request(s)`,type:"success"})):_notification.default.addNotification({message:response.message||"Error acknowledging requests",type:"error"})})).fail((error=>{console.error("AJAX Error:",error),_notification.default.addNotification({message:"Error communicating with server: "+(error.message||"Unknown error"),type:"error"})})):_notification.default.addNotification({message:"Please select at least one absence request to acknowledge",type:"warning"})}updateAcknowledgeIcon(element,acknowledged){1===acknowledged?(element.classList.remove("fa-times"),element.classList.add("fa-check"),element.style.color="green",element.setAttribute("title","Acknowledged - Click to toggle")):(element.classList.remove("fa-check"),element.classList.add("fa-times"),element.style.color="red",element.setAttribute("title","Not acknowledged - Click to toggle"))}updateSelectAllState(){const allCheckboxes=document.querySelectorAll(".absence-checkbox"),checkedCheckboxes=document.querySelectorAll(".absence-checkbox:checked");if(0===allCheckboxes.length)return;const selectAllCheckbox=document.getElementById("select_all_absences");selectAllCheckbox&&(0===checkedCheckboxes.length?(selectAllCheckbox.checked=!1,selectAllCheckbox.indeterminate=!1):checkedCheckboxes.length===allCheckboxes.length?(selectAllCheckbox.checked=!0,selectAllCheckbox.indeterminate=!1):(selectAllCheckbox.checked=!1,selectAllCheckbox.indeterminate=!0))}updateBulkButton(){const checkedCount=document.querySelectorAll(".absence-checkbox:checked").length,container=document.getElementById("bulk-acknowledge-container"),countSpan=document.getElementById("selected_count");container&&(checkedCount>0?(container.style.display="",countSpan&&(countSpan.textContent=checkedCount)):container.style.display="none")}};var _default={init:()=>absenceAcknowledge.init()};return _exports.default=_default,_exports.default}));

//# sourceMappingURL=acknowledge.min.js.map